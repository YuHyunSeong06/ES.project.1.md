---

# 1. 임베디드 시스템의 설계

# 습관 형성 스마트 잠금 의자 (집중 의자)

---

## 1) 문제 인식

저와 같은 학생들 중에는 공부 습관이 잡혀 있지 않아, 1시간 동안 집중은커녕 앉아 있는 것조차 힘든 경우가 많습니다.
이들의 자기 통제력 부족은 단순한 의지의 문제가 아니라 **환경적 요인과 습관 형성의 부재**에서 비롯된다고 판단했습니다.

> “앉아 있기가 힘든 사람에게, 억지로라도 ‘앉아 있게 만드는 환경’을 주면 어떨까?”
> 라는 생각에서 출발하여 **‘습관 형성 스마트 잠금 의자’**를 기획했습니다.
> 수업 시간에 배운 임베디드 시스템 기술을 통해 충분히 구현 가능하다고 판단했습니다.

---

## 2) 작품 개요

* 사용자가 의자에 앉으면, 시트 아래의 **하중 감지 센서(Load Cell)** 가 20kg 이상을 감지합니다.
  (사용자 연령대에 따라 제품군의 무게 기준을 다르게 설정할 수 있습니다.)
* 일정 하중이 감지되면 **팔걸이 자동 잠금장치**가 작동하여 사용자의 허벅지 위쪽 공간으로 **바(bar)** 가 내려옵니다.
  바는 직접적으로 허벅지를 누르지 않으며, 사용자가 간단한 스트레칭은 가능하지만 완전히 일어설 수는 없습니다.
* 사용자는 최소 50분 이상 고정된 상태로 집중할 수 있으며,
  설정 시간 경과 후에는 자동으로 잠금이 해제됩니다.
* 단, 사용자가 더 공부하고 싶을 경우 잠금 해제를 지연할 수 있도록 **햅틱 신호 후 수동 해제 버튼**을 두었습니다.
* 잠금 시간, 긴급 해제, 집중 기록 등은 **모바일 앱**과 **블루투스 통신(HC-06)** 으로 관리됩니다.

---

## 3) 주요 기능 요약

### (1) 자동 무게 감지 잠금 시스템

* Load Cell이 30kg 이상의 하중을 감지하면, 서보모터가 동작해 좌우 팔걸이 잠금바를 내림.
* 바는 허벅지 위 공간에 위치하여 완전한 기립을 방지함.
* 상체 이동과 스트레칭은 가능하도록 안전 설계.

### (2) 시간 기반 자동 해제 시스템

* 아두이노 내부 타이머 또는 millis() 함수로 타이머를 제어.
* 설정된 시간이 끝나면 진동모터가 1~2초간 작동해 “잠금 해제 가능” 신호 전달.
* 사용자가 **팔걸이 왼쪽의 버튼**을 눌러야 실제 잠금이 해제됨.

### (3) 앱 연동 기능 (Bluetooth 기반)

* HC-06 블루투스 모듈로 스마트폰과 연결.
* 앱에서 다음 항목 설정 가능:

  * 잠금 시간 (30분~120분)
  * 긴급 잠금 해제 (하루 3회 제한)
  * 집중 기록 확인, 친구 간 집중 랭킹 시스템
  * 아바타 커스터마이징 및 토큰 보상 시스템

### (4) 안전 기능

* 버튼을 통한 긴급 해제 가능.
* 완충 패드와 곡선형 구조로 안전 확보.
* 전원은 **USB 또는 C타입 어댑터**를 사용.

---

## 4) 기대 효과

* **집중력 향상:** 물리적 제약을 통한 습관 형성
* **공부 루틴 관리:** 점진적 잠금 시간 확장으로 지속적 집중 습관 개발
* **심리적 보상:** 집중 종료 시 성취감 제공
* **학습 보조:** 집중력 향상이 필요한 학생 및 직장인에게 도움

---

## 5) 필요 부품 및 구성요소

| 구성 요소             | 역할        |
| ----------------- | --------- |
| 아두이노 Uno          | 전체 시스템 제어 |
| 로드셀 센서 + HX711 모듈 | 착석 감지     |
| 서보모터 2개           | 좌우 팔걸이 제어 |
| 진동 모터             | 시간 종료 알림  |
| HC-06 블루투스 모듈     | 앱 연동      |
| 버튼 스위치            | 수동 해제     |
| 배터리 / 어댑터         | 전원 공급     |

---

## 6) 권장 하드웨어 구성

**(1) 회로 구성 요약도**

* 로드셀 → HX711 → 아두이노 아날로그 입력
* HC-06 블루투스 모듈 → TX/RX 핀 연결
* 서보모터 2개 → PWM 핀 (예: 9, 10)
* 진동모터 → 디지털 출력 (트랜지스터 스위칭 포함)
* 버튼 스위치 → 디지털 입력 (Pull-up 저항 사용)

**(2) 전원 설계**

* 전체 시스템: 5V DC
* 서보모터는 전류가 높으므로 별도의 전원선(공통 GND) 분리 권장
* 전류 보호용으로 1A 이상 USB 어댑터 사용

---

## 7) 전기 / 논리 설계

| 센서/모듈     | 입력/출력  | 조건         | 동작            |
| --------- | ------ | ---------- | ------------- |
| Load Cell | 입력     | 20kg 이상 감지 | 잠금바 작동        |
| Timer     | 내부 로직  | 설정 시간 만료   | 햅틱 알림 + 해제 대기 |
| 버튼        | 입력     | 사용자가 눌렀을 때 | 잠금 해제         |
| HC-06     | 시리얼 통신 | 앱에서 신호 수신  | 시간 설정, 긴급 해제  |
| 서보모터      | 출력     | 잠금/해제 명령 시 | 바 이동 제어       |
| 진동모터      | 출력     | 시간 종료 시    | 햅틱 피드백 발생     |

---

## 8) 의사코드 (Pseudo Code)

```c
setup() {
  init_loadcell();
  init_servo();
  init_bluetooth();
  init_vibration();
  init_button();
}

loop() {
  weight = read_loadcell();

  if (weight > 20kg && locked == false) {
      lock_bar();         // 서보모터 하강
      start_timer();      // 잠금 타이머 시작
      locked = true;
  }

  if (locked == true && timer_finished()) {
      vibrate_seat();     // 진동 신호
      unlock_ready = true;
  }

  if (unlock_ready && button_pressed()) {
      unlock_bar();       // 서보모터 상승
      locked = false;
      unlock_ready = false;
  }

  if (bluetooth_signal_received()) {
      update_lock_time();
      check_emergency_unlock();
  }
}
```

---

## 9) 테스트 계획

| 테스트 항목    | 절차                 | 기대 결과               |
| --------- | ------------------ | ------------------- |
| 하중 감지 정확도 | 다양한 무게(10~60kg) 적용 | 20kg 이상에서 정확히 잠금 작동 |
| 잠금/해제 동작  | 앉기 → 해제 버튼 누르기     | 서보모터 정상 작동          |
| 타이머 동작    | 50분 타이머 설정 후 대기    | 햅틱 반응 + 버튼 해제 가능    |
| 블루투스 통신   | 앱과 HC-06 연결        | 시간 설정 및 긴급 해제 명령 수신 |
| 긴급 해제 기능  | 버튼 장시간 누름          | 즉시 잠금 해제            |
| 전원 안정성    | USB 어댑터 연결         | 전압 강하 없이 정상 작동      |

---

## 10) 향후 확장 계획

* **앉은 자세 감지 센서** 추가 (자세 교정 기능)
* **앱 집중 그래프 시각화** 및 AI 기반 루틴 추천
* **친구 초대 랭킹전** 등 동기부여 시스템 강화
* **IOT 확장** → Wi-Fi 모듈(ESP8266)로 원격 제어

---
---

## 11) 앱 UI 설계 (Bluetooth 연동 기반)

### 앱의 목적

스마트 잠금 의자와 사용자의 스마트폰을 연결하여,

* 잠금 시간 조절
* 긴급 해제 관리
* 집중 기록 시각화
* 경쟁/보상 시스템
  을 통합적으로 관리하기 위함입니다.

---

### 주요 메뉴 구성

| 메뉴              | 기능 설명                             |
| --------------- | --------------------------------- |
| **홈(Home)**     | 현재 집중 시간, 남은 시간, 의자 연결 상태 표시.     |
| **타이머 설정**      | 최소 30분 ~ 최대 120분까지 슬라이더로 조정 가능.   |
| **긴급 해제**       | 하루 3회 제한. 버튼 클릭 시 즉시 해제 명령 전송.    |
| **기록 보기**       | 하루/주간 집중시간 그래프 및 해제 횟수 표시.        |
| **랭킹 / 보상**     | 다른 사용자와 집중시간 비교 랭킹, 토큰/아바타 관리.    |
| **설정(Setting)** | 블루투스 재연결, 알림음 on/off, 진동 강도 설정 등. |

---

### 홈 화면 개념도 (텍스트 버전)

```
───────────────────────────────
[ Focus Seat 🪑 ]     연결됨 🔵

⏱ 현재 집중 시간: 32분 / 50분
🩶 남은 시간: 18분

진행 중 잠금 상태입니다 🔒
───────────────────────────────

[ 일시정지 ❙❙ ]     [ 긴급 해제 🚨 ]  

───────────────────────────────
오늘의 집중 통계
📊 집중 시간: 3시간 20분
🔁 해제 횟수: 1회
───────────────────────────────
```

---

### 랭킹 / 보상 페이지 개념도

```
───────────────────────────────
🔥 집중 랭킹 (매일 04:00 초기화)
───────────────────────────────
1위  | user_A  | 7시간 12분
2위  | user_B  | 6시간 40분
3위  | 나 (you) | 5시간 55분
───────────────────────────────
🎁 오늘의 보상: 7시간 이상 달성 → 토큰 3개 지급!

내 아바타 👤 : '공부하는 로봇'
[ 아바타 변경 ] [ 토큰 상점 🛒 ]
───────────────────────────────
```

---

### 주요 인터랙션 플로우

1. **앱 실행 → 블루투스 연결 요청**

   * HC-06 모듈과 페어링
   * 연결 성공 시 홈 화면으로 이동

2. **사용자 잠금 시간 설정 (30~120분)**

   * 슬라이더로 시간 선택
   * “시작하기” 버튼 클릭 → 아두이노로 시간 값 전송

3. **앉기 감지 (로드셀 입력)**

   * 사용자가 앉으면 아두이노가 잠금 시작 신호를 앱으로 송신
   * 앱은 “집중 세션 시작” UI로 변경

4. **타이머 진행 중 (집중 모드)**

   * 남은 시간 실시간 업데이트
   * 앱은 블루투스를 통해 아두이노와 주기적 통신 (1~2초 간격)

5. **시간 종료 → 햅틱 신호 발생**

   * 아두이노에서 “unlock ready” 상태 전송
   * 앱 화면에 “집중 세션 종료됨, 해제 버튼을 눌러주세요” 표시

6. **해제 버튼 누름 → 아두이노 잠금 해제**

   * 아두이노가 서보모터 제어 → 잠금바 상승
   * 앱에서 집중 기록을 저장

7. **랭킹/보상 업데이트**

   * 하루 누적 시간 기준으로 토큰 및 랭킹 업데이트

---

## 12) 전체 작동 플로우 다이어그램 (논리 흐름 요약)

```
┌──────────────────────────────┐
│         전원 ON / 대기상태         │
└───────┬──────────────────────┘
        │
        ▼
┌──────────────────────────────┐
│    사용자가 앉음 (하중 감지 >20kg)   │
└───────┬──────────────────────┘
        │
        ▼
┌──────────────────────────────┐
│     팔걸이 바 잠금 (서보모터 작동)    │
│     타이머 시작 (앱 설정값 기준)     │
└───────┬──────────────────────┘
        │
        ▼
┌──────────────────────────────┐
│       집중 세션 진행 중        │
│  - 남은 시간 표시              │
│  - 블루투스 주기적 통신 유지     │
└───────┬──────────────────────┘
        │
        ▼
┌──────────────────────────────┐
│    타이머 만료 (집중 종료)       │
│  - 진동 모터로 햅틱 피드백 전달   │
│  - 해제 대기 상태로 전환         │
└───────┬──────────────────────┘
        │
        ▼
┌──────────────────────────────┐
│  사용자가 해제 버튼 누름 → 잠금 해제 │
│  - 서보모터 상승                  │
│  - 앱에 기록 저장                 │
└───────┬──────────────────────┘
        │
        ▼
┌──────────────────────────────┐
│     랭킹 / 토큰 보상 시스템 갱신    │
└──────────────────────────────┘
```

---

## 13) 추가 구현 아이디어

| 확장 요소          | 설명                          |
| -------------- | --------------------------- |
| **앱 진동/알림 연동** | 집중 종료 시 스마트폰도 동시에 진동        |
| **사용자 통계 시각화** | 주간 집중 패턴 그래프 제공             |
| **집중 배틀 모드**   | 친구와 동시에 타이머 실행, 방해 금지 모드    |
| **AI 루틴 추천**   | 사용자의 집중 이력 기반으로 자동 잠금 시간 추천 |
| **앉은 자세 인식**   | 추가 센서 부착 시 자세 모니터링 가능       |

---
